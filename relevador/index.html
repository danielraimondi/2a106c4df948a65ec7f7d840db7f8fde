
<!doctype html>


<html>
<head lang="en">
	<meta charset="utf-8">
	<!--<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=scale">-->
	
	<title>Relevando.com</title> 
	<meta name="description" content="BlackTie.co - Free Handsome Bootstrap Themes" />	    
	<meta name="keywords" content="themes, bootstrap, free, templates, bootstrap 3, freebie,">
	<meta property="og:title" content="">

	<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.css" type="text/css" media="screen">
    <link rel="stylesheet" href="css/font-awesome.min.css" rel="stylesheet">
	
	<link rel="stylesheet" type="text/css" href="css/style.css">	
	
	
	
    
	<link rel="prefetch" href="images/zoom.png">
	
	 <!--<meta name="viewport" content="width=device-width, initial-scale=1.0">-->
 
    <!-- Bootstrap core CSS -->
    <!--<link href="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.1.1/css/bootstrap.css" rel="stylesheet" media="screen">-->
 	
 	
 	<script type="text/javascript">
		var nextinput = 0;
		function AgregarCampos(){
		nextinput++;
		campo = '<li id="rut'+nextinput+'">Campo:<input type="text" size="20" id="campo' + nextinput + '"&nbsp; name="campo' + nextinput + '"&nbsp; /></li>';
		$("#campos").append(campo);
		}
	</script>
	
	<script>
	    function sleep(milliseconds) {
		  var start = new Date().getTime();
		  for (var i = 0; i < 1e7; i++) {
		    if ((new Date().getTime() - start) > milliseconds){
		      break;
		    }
		  }
		}
	    
	    function muestraMensaje() {
		
		var fechaCompleta = new Date();
		var	fecha = fechaCompleta.getFullYear()+'-'+(fechaCompleta.getMonth()+1)+'-'+fechaCompleta.getDate();
		var	idCliente = document.getElementById('selectCliente').value;
		
		for (var p in productos){
            	
            	$.ajax({
	                url: "https://test-danielraimondi.c9.io/relevando/api/web/v1/survey",
	                type: 'POST',
	                dataType: 'json',
	                data: {
	                	survey_date: fecha,
	                	client_id: idCliente,
	                	user_id: 15,  //harcodeado
	                	prod_id: (document.getElementById("id"+productos[p]).innerHTML),
	                	stock: (document.getElementById("stock"+productos[p]).value),
	                	order: (document.getElementById("order"+productos[p]).value)
	                }
	               
            	}); //ajax
            	sleep(200);

		}; // for
		alert("Pedido enviado Correctamente");

		}
	</script>
			     	
 	
</head>

<body>
	<div class="navbar navbar-fixed-top" data-activeslide="1">
		<div class="container">
		
			<!-- .navbar-toggle is used as the toggle for collapsed navbar content -->
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
			
			<div class="nav-collapse collapse navbar-responsive-collapse">
				<ul class="nav row">
					<li data-slide="1" class="col-12 col-sm-2"><a id="menu-link-1" href="#slide-1" title="Next Section"><span class="icon icon-home"></span> <span class="text">INICIO</span></a></li>
					<li data-slide="2" class="col-12 col-sm-2"><a id="menu-link-2" href="#slide-2" title="Next Section"><span class="icon icon-map-marker"></span> <span class="text">RUTAS</span></a></li>
					<li data-slide="3" class="col-12 col-sm-2"><a id="menu-link-3" href="#slide-3" title="Next Section"><span class="icon icon-briefcase"></span> <span class="text">REALIZAR PEDIDO</span></a></li>
				<!--	<li data-slide="4" class="col-12 col-sm-2"><a id="menu-link-4" href="#slide-4" title="Next Section"><span class="icon icon-barcode"></span> <span class="text">PEDIDOS</span></a></li>-->
					<li data-slide="5" class="col-12 col-sm-2"><a id="menu-link-4" href="#slide-4" title="Next Section"><span class="icon icon-signal"></span> <span class="text">ESTADO</span></a></li>
					<li data-slide="6" class="col-12 col-sm-2"><a id="menu-link-6" href="#slide-6" title="Next Section"><span class="icon icon-envelope"></span> <span class="text">CONTACTO</span></a></li>
				</ul>
				<div class="row">
					<div class="col-sm-2 active-menu"></div>
				</div>
			</div><!-- /.nav-collapse -->
		</div><!-- /.container -->
	</div><!-- /.navbar -->
	
	
	<!-- === Arrows === -->
	<div id="arrows">
		<!--<div id="arrow-up" class="disabled"></div>-->
		<!--<div id="arrow-down"></div>-->
		<!--<div id="arrow-left" class="disabled visible-lg"></div>-->
		<!--<div id="arrow-right" class="disabled visible-lg"></div>-->
	</div><!-- /.arrows -->
	
	
	<!-- === MAIN Background  Inicio=== -->
	<div class="slide story" id="slide-1" data-slide="1">
		<div class="container">
			<div id="home-row-1" class="row clearfix">
				<div class="col-12">
					<h1 class="font-semibold">Relevando.com </h1>
					<h4 class="font-thin">Bienvenido a nuestra aplicación RELEVANDO.COM.UY  </h4>
					<h4> <a class="font-semibold" href="#">acceso a usuarios</a> </h4>
				
				</div><!-- /col-12 -->
			</div><!-- /row -->
			<div id="home-row-2" class="row clearfix">
				<div class="col-12 col-sm-4"><div class="home-hover navigation-slide" data-slide="2"><img src="images/s01.png"></div><span>RUTAS</span></div>
				<div class="col-12 col-sm-4"><div class="home-hover navigation-slide" data-slide="3"><img src="images/s03.png"></div><span>REALIZAR PEDIDO</span></div>
			<!--	<div class="col-12 col-sm-3"><div class="home-hover navigation-slide" data-slide="4"><img src="images/s02.png"></div><span>PEDIDOS</span></div> -->
				<div class="col-12 col-sm-4"><div class="home-hover navigation-slide" data-slide="5"><img src="images/s04.png"></div><span>ESTADO</span></div>
			</div><!-- /row -->
		</div><!-- /container -->
	</div><!-- /slide1 -->
	
	<!-- === Slide 2  rutas=== -->
	<div class="slide story" id="slide-2" data-slide="2">
		<div class="container">
			<div class="row title-row">
				<div class="col-12 ">Mis Rutas</div>
			</div><!-- /row -->
			<div class="row line-row">
				<div class="hr">&nbsp;</div>
			</div><!-- /row -->
			<div align="center">
				<div class="client-map">
					<div id="map" style="height:500px; width:80%;"></div>
				</div>
			</div><!-- /row -->
		</div><!-- /container -->
	</div><!-- /slide2 -->
	
	<!-- === SLide 3 - stock -->
	<div class="slide story" id="slide-3" data-slide="3">
		<div class="row">
		
		</div><!-- /row -->
	</div><!-- /slide3 -->
	
	<!-- === Slide 4 - pedido === -->
	<div class="slide story" id="slide-4" data-slide="4">
		<div class="container">
			<div class="row title-row">
				<div class="col-12 ">Realizar pedido</div>
			</div><!-- /row -->
			
					<div id='tabla' class="table-responsive" style="width:100%;">
						<form id='formulario'>
							<label for='selectCliente'>Cliente:</label>
							<select id="selectCliente"></select>
							<table id='tablaPedidos' class='table' cellspacing='0' width='50%' align='center'></table>
						</form>
					</div>
		   	<button type="button" id="EnviarPedido" onclick="muestraMensaje()">Envia Pedido</button>
		</div><!-- /container -->
	</div><!-- /slide4 -->
	
	<!-- === Slide 5 / ESTADO === -->
	<div class="slide story" id="slide-5" data-slide="5">
		<div class="container">
			<div class="row title-row">
				<div class="col-12 font-light">Estado de cumplimiento</div>
			</div>
			<div class="row subtitle-row">
				<div class="col-12 font-light">Total cumplido del <span class="font-semibold">día</span></div>
			</div>
			<div class="progress">
			  <div class="progress-bar progress-bar-success progress-bar-striped active" role="progressbar"
			  aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width:40%">
			   </div>
			</div>
		</div><!-- /container -->
	</div><!-- /Slide 5 -->
	
	<!-- === Slide 6 / contacto === -->
	<div class="slide story" id="slide-6" data-slide="6">
		<div class="container">
			<div class="row title-row">
				<div class="col-12 font-light">Dejenos su <span class="font-semibold">mensaje</span></div>
			</div><!-- /row -->
			<div class="row line-row">
				<div class="hr">&nbsp;</div>
			</div><!-- /row -->
			<div class="row subtitle-row">
				<div class="col-sm-1 hidden-sm">&nbsp;</div>
				<div class="col-12 col-sm-10 font-light">Puede contactare con nosotros a través de culquiera de los siguientes enlaces</div>
				<div class="col-sm-1 hidden-sm">&nbsp;</div>
			</div><!-- /row -->
			<div id="contact-row-4" class="row">
				<div class="col-sm-1 hidden-sm">&nbsp;</div>
				<div class="col-12 col-sm-2 with-hover-text">
					<p><a target="_blank" href="#"><i class="icon icon-phone"></i></a></p>
					<span class="hover-text font-light ">+598 091.265.816</span></a>
				</div><!-- /col12 -->
				<div class="col-12 col-sm-2 with-hover-text">
					<p><a target="_blank" href="#"><i class="icon icon-envelope"></i></a></p>
					<span class="hover-text font-light ">info@relevando.com.uy</span></a>
				</div><!-- /col12 -->
				<div class="col-12 col-sm-2 with-hover-text">
					<p><a target="_blank" href="#"><i class="icon icon-home"></i></a></p>
					<span class="hover-text font-light ">Montevideo, Uruguay<br>código postal 11800</span></a>
				</div><!-- /col12 -->
				<div class="col-12 col-sm-2 with-hover-text">
					<p><a target="_blank" href="#"><i class="icon icon-facebook"></i></a></p>
					<span class="hover-text font-light ">facebook/relevando.com.uy</span></a>
				</div><!-- /col12 -->
				<div class="col-12 col-sm-2 with-hover-text">
					<p><a target="_blank" href="#"><i class="icon icon-twitter"></i></a></p>
					<span class="hover-text font-light ">@Relevando.com.uy</span></a>
				</div><!-- /col12 -->
				<div class="col-sm-1 hidden-sm">&nbsp;</div>
			</div><!-- /row -->
		</div><!-- /container -->
	</div><!-- /Slide 6 -->
	
</body>

	<!-- SCRIPTS -->
	<script src="js/html5shiv.js"></script>
	<script src="js/jquery-1.10.2.min.js"></script>
	<script src="js/jquery-migrate-1.2.1.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/jquery.easing.1.3.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.js"></script>
	<script type="text/javascript" src="https://cdn.datatables.net/1.10.10/js/jquery.dataTables.min.js"></script>
	<link rel="stylesheet" href="https://cdn.datatables.net/1.10.10/js/dataTables.bootstrap.min.js" type="text/css" media="screen">
	<script src="js/crearTabla.js"></script>
	<script src="js/script.js"></script>
	<script type = "text/javascript">
	  function update(id){
	    //Get contents off cell clicked
	    var content = document.getElementById(id).firstChild.nodeValue;
	    //Switch to text input field
	    document.getElementById(id).innerHTML = "<input type = 'text' name = 'txtNewInput' id = 'txtNewInput' value = '" + content + "'/>";
	  }
	</script>
					

	<script>
	// $(document).ready(function(e) {

		
	// 	function muestraMensaje() {
	// 			console.log("hago click2");
	// 			var fechaCompleta = new Date();
	// 			var	fecha = fechaCompleta.getFullYear()+'-'+(fechaCompleta.getMonth()+1)+'-'+fechaCompleta.getDate();
	// 			var	idCliente = document.getElementById('selectCliente').value;
				
	// 			for (var p in productos){
                    	
 //                   	$.ajax({
	// 		                url: "https://test-danielraimondi.c9.io/relevando/api/web/v1/survey",
	// 		                type: 'POST',
	// 		                dataType: 'json',
	// 		                data: {
	// 		                	survey_date: fecha,
	// 		                	client_id: idCliente,
	// 		                	user_id: 1,  //harcodeado
	// 		                	prod_id: (document.getElementById("id"+productos[p]).innerHTML),
	// 		                	stock: (document.getElementById("stock"+productos[p]).value),
	// 		                	order: (document.getElementById("order"+productos[p]).value)
	// 		                }
			               
 //                   	}); //ajax

	// 			}; // for  
	// 		}
	// });
	
		$(document).ready(function() {
			
			//	'login-form[login]': 'daniel',
            //    	'login-form[password]': 'daniel',
			// $.ajax({
   //             url: "https://test-danielraimondi.c9.io/relevando/api/web/v1/user/login",
   //             type: 'POST',
   //             dataType: 'json',
   //             data: {
   //             	'username': 'admin',
   //             	'password': '123123',
   //             }
               
   //     	}).then(function(result) {
   //     			alert(result);
   //     			console.log(result);
   //     	});
   			
   			if (localStorage.getItem("id")==null)
   				window.location.replace("login.html");
   			else
		    	user_id=localStorage.getItem("id");
		    	
			waypoints=[];
			
			var origen;
			
			initMap();
			var directionDisplay = new google.maps.DirectionsRenderer;
			
			$.ajax({
			        url: "https://test-danielraimondi.c9.io/relevando/api/web/v1/user/"+user_id
				    }).then(function(data) {
		        
		        		origen = new google.maps.LatLng ({lat: parseFloat(data.user_lat), 
		        			lng: parseFloat(data.user_lng)});
		        			
		        		$.ajax({
					        url: "https://test-danielraimondi.c9.io/relevando/api/web/v1/route/clientes"
						    }).then(function(data) {
						    	
						    	route = data;
						    	for (c in data){  
					        
					        
								        var loc = new google.maps.LatLng({lat: parseFloat(data[c].client_lat), lng: parseFloat(data[c].client_long)});
								        
								        // var marker = new google.maps.Marker({
								        //     position: loc,
								        //     map: map
			
								        // });
								        	
								        waypoints.push({
				                            location: loc,
				                            stopover: true            
				                        });
							        
						    		};  //for  
						    		
						    		var service = new google.maps.DirectionsService();
						    		directionDisplay.setMap(map);
		            
						            console.log(waypoints);
						            console.log(waypoints[0].location.lat());
						            
						            console.log(service);
						            service.route({
						              origin: origen,
						              destination: origen,
						              waypoints: waypoints,
						              travelMode: google.maps.DirectionsTravelMode.WALKING,
						              optimizeWaypoints: true
							            }, function(result,status){
							                 directionDisplay.setDirections(result);
							                  console.log(status);
							                  console.log(result);
						            });
						            
						       
						           
		
			   		}); // callback    		
		
	   }); // callback  
		    
		    
		    
		    
		    $.ajax({
		        url: "https://test-danielraimondi.c9.io/relevando/api/web/v1/route/clientes"
		    }).then(function(route) {
		    	$.ajax({
		        url: "https://test-danielraimondi.c9.io/relevando/api/web/v1/survey/cumplidas_hoy"
		    		}).then(function(relevadoosHoy) {
		      // console.log(JSON.stringify(route));
		       
		       //cargar puntos de los locales a relevar en el mapa
		       //var p;
		       //var rutaCliente = [];
		       // var flightPlanCoordinates = [];
		       //for (p in route){
		       //	rutaCliente.push(route[p]);
		         //   var markerIcon = {
			        //             url: "images/shop2.ico",
			        //             size: new google.maps.Size(32, 32),
			        //             //origin: new google.maps.Point(0, 0),
			        //             anchor: new google.maps.Point(15, 25),
			        //             scaledSize: new google.maps.Size(32, 32)
			        //         };
			        
			        // var marker = new google.maps.Marker({
			        //     position: {lat: parseFloat(rutaCliente[p].client_lat), lng: parseFloat(rutaCliente[p].client_long)},
			        //     map: map,
			        //     icon: markerIcon
			            
			        // });
			        // flightPlanCoordinates.push(new google.maps.LatLng(parseFloat(rutaCliente[p].client_lat),parseFloat(rutaCliente[p].client_long)));
      
			 
		       //}
		       
		  //  var flightPath = new google.maps.Polyline({
		  //  path: flightPlanCoordinates,
		  //  strokeColor: "#FF0000",
		  //  strokeOpacity: 1.0,
		  //  strokeWeight: 2
		  //});
		
		  //flightPath.setMap(map);
		  
		       // Esta función calcula la ruta con el API de Google Maps  
			    
		       //cargar porcentaje de relevados
		           //var $catProd = productos.length;
				   var $relHoy = relevadoosHoy[0].cantidad;
				   var $bar = $('.progress-bar');
				   $bar.width($relHoy  * 1000 / route.length);
				   console.log("relevados hoy " + $relHoy  + "cantidad de clientes" + route.length);
				   $bar.text( Math.round($relHoy * 100 / route.length) + "%");
	    		});
		    });
		    
		    // cargar productos y enviar pedidos
		    
		    productos=[];
			
			$.ajax({
				url: "https://test-danielraimondi.c9.io/relevando/api/web/v1/route/clientes",
				type: 'GET',

				success: function(result) {

					var combo = document.getElementById('selectCliente'),
						temp = '';
						
					for (var c in result){
						temp += "<option value='"+result[c].client_id+"'>"+result[c].client_name+"</option>";	
					}
					combo.innerHTML += temp;
					
				 },

				error: function (request, status, error) {
					alert("No se puede conectar con el servidor...");
				}
			});

            $.ajax({
                url: "https://test-danielraimondi.c9.io/relevando/api/web/v1/product/ver?_format=json",
                type: 'GET',
                
                success: function(result) {
                    
                    
                    var divTabla= document.getElementById('tablaPedidos'),
                    	temp = '',
                    	dataTemp;

                    temp +="<thead><tr><th>ID</th><th>Producto</th><th>Stock</th><th>Pedir</th></tr></thead><tbody>";
                    
                    for (var i=0, tam=result.data.length; i< tam; i++){
                    	dataTemp = result.data[i];
                    	productos.push(dataTemp[0]);
                    	temp += "<tr><td id='id"+dataTemp[0]+"'>"+dataTemp[0]+"</td><td>"+dataTemp[1]+"</td><td><input value=0 id='stock"+dataTemp[0]+"'></td><td><input value=0 id='order"+dataTemp[0]+"'></td></tr>";	
                    }
                    temp += "</tbody></form>";
                    divTabla.innerHTML = temp;
                }, 
                error: function (request, status, error) {
		        alert("No se puede conectar con el servidor...");
		    	}
            });
			
		    
		});
	  // In the following example, markers appear when the user clicks on the map.
	  // The markers are stored in an array.
	  // The user can then click an option to hide, show or delete the markers.
	  var map;
	  var markers = [];
	      
	  function initMap() {
	    var center = {lat: -34.893753, lng: -56.165217};
	    map = new google.maps.Map(document.getElementById('map'), {
	    zoom: 13,
	    center: center,
	    mapTypeId: google.maps.MapTypeId.TERRAIN
	    });
	    prev_infowindow = false;
	    
	   	  var myLatLng = new google.maps.LatLng(0, -180);
		  var myOptions = {
		    zoom: 3,
		    center: myLatLng,
		    mapTypeId: google.maps.MapTypeId.TERRAIN
		  };
		
		  
	    
	  }

	
	</script>
	
	
	<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=places,drawing,geometry,directions"></script>
	<!--<script async defer-->
	<!--  src="https://maps.googleapis.com/maps/api/js?v=3.exp&callback=initMap">-->
	<!--</script>-->

</html>